You are a senior full‑stack engineer on GCP. Update the EXISTING repo to ship the MVP dashboard **EtsyNova** using the plan below. Reuse code already present (some generated by Claude previously). Keep secrets/tokens server‑side.

## What to do (high level)
1) **Repo reconnaissance**
   - Print a concise repo tree (depth 2) and detect stacks:
     - Frontend: Next.js (App Router) or React+Vite.
     - Backend: FastAPI directory (or create it under /api).
   - List gaps vs the plan below.

2) **Env & config**
   - Add/update `.env.example` (root and per app) with keys:
     APP_NAME, DASHBOARD_SHARED_EMAIL, SESSION_SECRET, ETSY_CLIENT_ID, ETSY_CLIENT_SECRET, ETSY_REDIRECT_URI,
     GCP_PROJECT_ID, GCP_REGION, USE_REDIS_CACHE=false, PERSIST_PII=false, MOCK_MODE=true,
     LLM_PROVIDER=none|openai|anthropic|vertex, OPENAI_API_KEY, ANTHROPIC_API_KEY, GOOGLE_API_KEY,
     LANGSMITH_API_KEY, LANGSMITH_PROJECT=EtsyNova, LANGCHAIN_TRACING_V2=true.

3) **Backend (FastAPI on Cloud Run)**
   - Create/ensure structure:
     /api/app/main.py (FastAPI app), /api/app/routers/{auth,metrics,reports,health}.py,
     /api/app/services/{etsy_client,aggregator,summarizer,suggestor,cache}.py,
     /api/app/agent/{graph.py,prompts.py,models.py,heuristics.py}
     /api/app/models/{kpis.py, listings.py, auth.py} (Pydantic models).
   - Middleware: **CORS** via env `ALLOWED_ORIGINS` (include localhost ports and CDN domain), request logging.
   - **Auth routes**:
     POST /auth/etsy/connect → { auth_url }
     GET  /auth/etsy/callback → { connected:true, shop_id }
     GET  /auth/status → { connected:bool, pending:bool, shop_id? }
     POST /auth/etsy/disconnect → { disconnected:true }
   - **Metrics routes**:
     GET /metrics/shop?shop_id&from&to → { orders, gmv, visits, views, conversion_rate, favorites, cart_adds, refunds, deltas }
     GET /metrics/listings?shop_id&from&to&limit=50 → { items:[...], top:{ by_views:[], by_orders:[], by_revenue:[] } }
     GET /metrics/trends?shop_id&from&to&series=revenue,orders,visits,views → time series
     GET /metrics/funnel?shop_id&from&to → { favorite_rate, add_to_cart_rate, conversion_rate }
   - **Reports**: GET /reports/summary → calls **LangGraph** when `LLM_PROVIDER!=none`, else `heuristics`.
   - **Health**: GET /health → { ok:true }
   - **etsy_client**: OAuth2 PKCE, token refresh on 401, retry/backoff on 429/5xx; return normalized shapes. When `MOCK_MODE=true` or creds missing, serve fixtures.
   - **Caching**: in‑memory or Redis (if `USE_REDIS_CACHE=true`). TTL 60–120s on metrics endpoints.
   - **PII**: never persist PII; add filter that redacts PII from logs and DB writes.
   - **OpenAPI** at /docs; include tags and examples.

4) **Agent (LangChain + LangGraph + LangSmith)**
   - Implement `/api/app/agent/models.py` with a provider selector: OpenAI/Anthropic/Vertex via env. Return a LangChain chat model.
   - Implement `/api/app/agent/prompts.py` with system + user templates; few‑shots for good summaries/suggestions.
   - Implement `/api/app/agent/heuristics.py` deterministic fallbacks (3–5 suggestions) so app works with `LLM_PROVIDER=none`.
   - Implement `/api/app/agent/graph.py` with a small DAG: load_context → summarize → suggest → guardrails. Validate outputs with Pydantic. Emit LangSmith traces when `LANGCHAIN_TRACING_V2=true`.

5) **Frontend**
   - Keep existing stack (Next or Vite). Add components/pages:
     - Header with **status pill** (Live/Pending/Demo), date picker, Refresh, Demo toggle.
     - KPI cards with deltas; Recharts: Revenue & Orders Trend; Traffic Overview; Conversion Funnel.
     - Top Listings tables (by views, orders, revenue) with deep links to Etsy.
     - "Generate Summary" section wired to **/reports/summary**.
     - Env: `NEXT_PUBLIC_API_BASE_URL` or `VITE_API_BASE_URL` accordingly.
     - Prefer static hosting (Next `next export` or Vite dist) on GCS + CDN.

6) **Mock fixtures**
   - Add `/api/fixtures/*.json` for shop, listings, trends, funnel.
   - Wire a flag to read fixtures when `MOCK_MODE=true` or `/auth/status.pending=true`.

7) **CI/CD (GitHub Actions)**
   - Workflow 1: Lint+Test for API and Web. Fail on missing OpenAPI examples.
   - Workflow 2: Deploy API to Cloud Run (min instances 0). Deploy Web to GCS + CDN.

8) **Tests**
   - Unit: oauth flow (mock token), aggregator deltas, summary heuristics, graph output schema validation.
   - API: happy paths + 429 retry.

9) **Docs**
   - Update README: local dev, env, deploy, switching MOCK→LIVE, LangSmith tracing toggle.

10) **Output**
   - Propose a small sequence of commits with messages. Then apply them.
   - Print final tree diff and next steps.

## Constraints & Notes
- Hosting on **GCP**. Cloud Run for API; **GCS + Cloud CDN** for static UI when possible.
- Etsy tokens **never** in the browser. Use HTTP‑only session cookies or backend session.
- If Etsy v3 lacks some traffic metrics, surface as **N/A** and do not fabricate.
- Human‑in‑the‑loop; no write actions in MVP.

Proceed without asking questions. If a choice is ambiguous, prefer **React+Vite SPA** for simpler ops; otherwise keep the current UI stack.